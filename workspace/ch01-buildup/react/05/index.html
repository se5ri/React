<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>05 Todo List - React ê¸°ëŠ¥ ì¶”ê°€</title>
    <link rel="icon" href="/assets/favicon.ico" type="image/x-icon" />
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7/babel.min.js"></script>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      /*
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€ App â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚           â”‚            â”‚
              Header       Todo        Footer
                            â”‚
                        â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”
                  TodoInput   TodoList
                                 â”‚
                              TodoItem
          */

      function Header() {
        return (
          <header>
            <h1>05 Todo List - React ê¸°ëŠ¥ ì¶”ê°€ ğŸ˜Š </h1>
            <p>
              íŒŒì¼ ê²½ë¡œ:{" "}
              <span id="filepath">{`ch${document.URL.split("/ch")[1]}index.html`}</span>
            </p>
          </header>
        );
      }

      function Footer() {
        return (
          <footer>
            <p>ë©‹ìŸì´ ì‚¬ìì²˜ëŸ¼ FrontEnd BootCamp</p>
          </footer>
        );
      }

      function Todo() {
        // ìƒ˜í”Œ ëª©ë¡
        const initItemList = [
          { num: 1, title: "ìë°”ìŠ¤í¬ë¦½íŠ¸ ê³µë¶€", done: true },
          { num: 2, title: "JS í”„ë¡œì íŠ¸", done: true },
          { num: 3, title: "React ê³µë¶€", done: false },
        ];

        // ìƒíƒœ ê´€ë¦¬
        // ìƒíƒœê°€ ìˆ˜ì •ë˜ë©´ í™”ë©´ì´ ë¦¬ë Œë”ë§ ë˜ëŠ” ë¦¬ì•¡íŠ¸
        const [itemList, setItemList] = React.useState(initItemList);

      
        // í• ì¼ ì¶”ê°€
        function addItem(title) {
          console.log("í• ì¼ ì¶”ê°€");
          // ë°ì´í„° ê°±ì‹ , itemListì— item ì¶”ê°€
          // num, title, done ì†ì„±ì„ ê°€ì§„ item ê°ì²´ ìƒì„±
          const item = { num: itemList[itemList.length-1]?.num + 1 || 1, title, done: false};
          //ê°ì²´ì˜ ë¶ˆë³€ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•œ ì½”ë“œ
          setItemList([...itemList,item]) // ë¹„ì–´ìˆëŠ” ìƒíƒœë¡œ ë³µì‚¬í•˜ê³  ìƒˆë¡œìš´ ì• ë¥¼ ì¶”ê°€í•´ì£¼ëŠ” ê²ƒ

          // itemList.push(item);
          // setItemList([...itemList]); // ê¸°ì¡´ì— ì†ì„±ì„ ê·¸ëŒ€ë¡œ ë³µì‚¬í•œ ì „ê°œ ë¬¸ë²• (ê¸°ì¡´ì˜ itemListê°€ ìƒˆë¡œìš´ itemListë¡œ ë°”ë€œ)
        }

        // ì™„ë£Œ/ë¯¸ì™„ë£Œ ì²˜ë¦¬
        function toggleDone(num) {
          console.log(num, "ì™„ë£Œ/ë¯¸ì™„ë£Œ");
          // ë°ì´í„° ê°±ì‹ , itemListì—ì„œ numì— í•´ë‹¹í•˜ëŠ” itemì˜ done ê°’ì„ ìˆ˜ì •
          // ê°ì²´ì˜ ë¶ˆë³€ì„±ì„ ìœ„í•´ì„œ
          const newItemList = itemList.map(item => item.num === num ? {...item, done: !item.done} : item);
          setItemList(newItemList);
        }

        // í• ì¼ ì‚­ì œ
        function deleteItem(num) {
          console.log(num, "í• ì¼ ì‚­ì œ");
          // ë°ì´í„° ê°±ì‹ , itemListì—ì„œ numì— í•´ë‹¹í•˜ëŠ” item ì‚­ì œ
          const newItemList = itemList.filter(item => item.num !== num);
          setItemList(newItemList);
        }



        return (
          <div id="main">
            <div id="container">
              <ul>
                <li>
                  <h2>ì‡¼í•‘ ëª©ë¡</h2>
                  <TodoInput addItem = { addItem } />
                  <TodoList itemList = {itemList} toggleDone={toggleDone} deleteItem={deleteItem}/>
                </li>
              </ul>
            </div>
          </div>
        );
      }

      function TodoInput({addItem}) {

        // ì¶”ê°€ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        const handleAdd = () => {
          console.log("ì¶”ê°€ ë²„íŠ¼ í´ë¦­");
          const inputElem = document.querySelector(".todoinput > input");
          if (inputElem.value.trim() !== "") {
            addItem(inputElem.value.trim());
            inputElem.value = "";
            inputElem.focus();
          }
        };

        // ì—”í„° ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        const handleAddKeydown = (event) => {
          console.log("keydown", event);
          if (event.key === "Enter") handleAdd();
        };


        return (
          <div className="todoinput">
            <input type="text" autoFocus onKeyDown = { handleAddKeydown } />
            <button type="button" onClick={ handleAdd } >ì¶”ê°€</button>
          </div>
        );
      }

      function TodoList({itemList, toggleDone, deleteItem}) {
        const list = itemList.map((item)=>{
          return <TodoItem key={item.num} item={item} toggleDone={toggleDone} deleteItem={deleteItem} />;
        })
        return (
          <ul className="todolist">
            {list}
            </ul>
        );
      }

      function TodoItem({item, toggleDone, deleteItem}) {
        console.log(item.num, 'ë¦¬ë Œë”ë§');
        return (
          <li>
            <span>{ item.num }</span>
            <span onClick = {() => toggleDone(item.num)} >{ item.done ?  <s>{ item.title }</s> : item.title }</span>
            <button type="button" onClick ={ () => deleteItem(item.num) }>ì‚­ì œ</button>
          </li>
        );
      }

      function App() {

        return (
          <div id="todo">
            <Header />
            <Todo />
            <Footer />
          </div>
        );
      }

      ReactDOM.createRoot(document.querySelector("#root")).render(<App />);
    </script>
  </body>
</html>
